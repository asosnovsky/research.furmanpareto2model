data.aus <- auscathist[c("Type","Year","OriginalCost")];
data.aus.split <- split(data.aus,data.aus$Type);
data.aus.agg <- data.frame(matrix(,ncol=1));
colnames(data.aus.agg) <- "Year";
for(t in data.aus.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
print(tmp);
data.aus.agg <- merge(data.aus.agg, tmp, all=T);
}
data.aus.agg[is.na(data.aus.agg)] <- 0
m = 10;
n = ceiling((2014-1967)/m);
data.aus.aggs <- matrix(NA,ncol=length(data.aus.agg)-1,nrow=m);
for(iDat in 2:length(data.aus.agg)) {
data.aus.aggs[,iDat-1] <- tapply(data.aus.agg[[iDat]],cut(1967:2014,n),FUN=sum);
}
data.aus.aggs <- data.frame(data.aus.aggs);
colnames(data.aus.aggs) <- colnames(data.aus.agg)[-1];
rownames(data.aus.aggs) <- paste0('[',(1:m-1)*n+1967,'-',(1:m)*n+1967,')');
View(nzcathist)
View(data.aus.aggs)
View(nzcathist)
barplot(data.aus.aggs)
barplot(matrix(unlist(data.aus.aggs),ncol=9))
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
tidyPath
write.table(data.aus.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
dir.create(tidyPath, showWarnings = T);
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
write.table(data.aus.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aus.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
print(tmp);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
m = 10;
n = ceiling((2014-1967)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(1967:2014,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+1967,'-',(1:m)*n+1967,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")]);
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")]);
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
print(tmp);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
View(auscathist)
max(auscathist$Year)
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
print(tmp);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,max(auscathist$Year),min(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,max(nzcathist$Year),min(nzcathist$Year));
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,max(auscathist$Year),min(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,max(nzcathist$Year),min(nzcathist$Year));
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);print(n);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,max(auscathist$Year),min(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,max(nzcathist$Year),min(nzcathist$Year));
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);print(n);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,min(auscathist$Year),max(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,min(nzcathist$Year),max(nzcathist$Year));
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
## Analyze and Save Function
analyzeANDSave <- function(data, m, minY, maxY)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
for(iDat in 2:length(data.agg)) {
print(cut(minY:maxY,n));
data.aggs[,iDat-1] <- tapply(data.agg[[iDat]],cut(minY:maxY,n),FUN=sum);
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
,sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,min(auscathist$Year),max(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,min(nzcathist$Year),max(nzcathist$Year));
520/60
520-8*60
data <- auscathist[c("Type","Year","OriginalCost")];
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
m=10
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
n
n = ceiling((maxY-minY)/m);
maxY = max(data$Year)
minY = min(data$Year);
maxY = max(data$Year);
minY = min(data$Year);
n = ceiling((maxY-minY)/m);
n
(1:m-1)*n
(1:m-1)*n+minY
(1:m)*n+minY
(0:m)*n+minY
iDate = 2
data.agg
incs[iDate]
incs <- (0:m)*n+minY;
incs[iDate]
data.agg < incs[iDate]
data.agg[data.agg < incs[iDate]]
View(data.agg[data.agg < incs[iDate]])
View(data.agg[,data.agg < incs[iDate]])
View(data.agg[data.agg$Year < incs[iDate]])
data.agg$Year < incs[iDate]
View(data.agg[data.agg$Year < incs[iDate],])
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
View(data.agg[cond,])
data.agg[cond,]
sum(data.agg[cond,])
data.agg[cond,-1]
colsums(data.agg[cond,-1])
colSums()
colSums(data.agg[cond,-1])
for(iDate in 2:length(incs)) {
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
data.aggs[iDate - 1] <- colSums(data.agg[cond,-1])
}
View(data.aggs)
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
data.aggs
for(iDate in 2:length(incs)) {
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
data.aggs[iDate - 1,] <- colSums(data.agg[cond,-1])
}
View(nzcathist)
View(data.aggs)
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
View(data.aggs)
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
data <- auscathist[c("Type","Year","OriginalCost")];
## Analyze and Save Function
analyzeANDSave <- function(data, m)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
maxY = max(data$Year);
minY = min(data$Year);
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
incs <- (0:m)*n+minY;
for(iDate in 2:length(incs)) {
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
data.aggs[iDate - 1,] <- colSums(data.agg[cond,-1])
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,min(auscathist$Year),max(auscathist$Year));
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,min(nzcathist$Year),max(nzcathist$Year));
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
data <- auscathist[c("Type","Year","OriginalCost")];
## Analyze and Save Function
analyzeANDSave <- function(data, m)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
maxY = max(data$Year);
minY = min(data$Year);
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
incs <- (0:m)*n+minY;
for(iDate in 2:length(incs)) {
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
data.aggs[iDate - 1,] <- colSums(data.agg[cond,-1])
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/aus.noanno.csv"),
row.names = FALSE,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/aus.anno.csv"),
sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10);
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10);
# Main data source: ACS_13_5YR_DP03.zip
rm(list=ls());
# Working Dir
homeDir = "~/Projects/York/Research/data";#linux
setwd(homeDir);
origPath <- file.path(homeDir,"original/CASdatasets/");
tidyPath <- file.path(homeDir,"tidy/CASdatasets/");
# Clean Old Data
unlink(tidyPath, r = T, f = T);
dir.create(tidyPath, showWarnings = T);
# Load Data
load(paste0(origPath, "auscathist.rda"));
load(paste0(origPath, "nzcathist.rda"));
data <- auscathist[c("Type","Year","OriginalCost")];
## Analyze and Save Function
analyzeANDSave <- function(data, m, ...)	{
data.split <- split(data,data$Type);
data.agg <- data.frame(matrix(NA,ncol=1));
colnames(data.agg) <- "Year";
for(t in data.split) {
tmp <- (aggregate(t[c("OriginalCost")],list(t$Year),mean));
colnames(tmp) <- c("Year", t$Type[1]);
data.agg <- merge(data.agg, tmp, all=T);
}
data.agg[is.na(data.agg)] <- 0
maxY = max(data$Year);
minY = min(data$Year);
n = ceiling((maxY-minY)/m);
data.aggs <- matrix(NA,ncol=length(data.agg)-1,nrow=m);
incs <- (0:m)*n+minY;
for(iDate in 2:length(incs)) {
cond <- (data.agg$Year < incs[iDate] & data.agg$Year >= incs[iDate-1])
data.aggs[iDate - 1,] <- colSums(data.agg[cond,-1])
}
data.aggs <- data.frame(data.aggs);
colnames(data.aggs) <- colnames(data.agg)[-1];
rownames(data.aggs) <- paste0('[',(1:m-1)*n+minY,'-',(1:m)*n+minY,')');
write.table(data.aggs,paste0(tidyPath,"/",...,".noanno.csv"),
row.names = FALSE,col.names = FALSE,sep = ",");
write.table(data.aggs,paste0(tidyPath,"/",...,".anno.csv"),
sep = ",");
}
analyzeANDSave(auscathist[c("Type","Year","OriginalCost")],10,'aus');
analyzeANDSave(nzcathist[c("Type","Year","OriginalCost")],10,'nz');
